project(
  'python-siphash24', 'c', 'cython',
  license: 'Apache-2.0 or LGPL-2.1-or-later',
  meson_version: '>= 0.63.0',
  default_options: [
    'buildtype=debugoptimized',
    'c_std=c99',
  ]
)

libcsiphash = dependency('libcsiphash-1', static: true)

py = import('python').find_installation()

tempita = files('tempita.py')

pyx = custom_target(
  'siphash24.pyx',
  input: 'siphash24.pyx.in',
  output: 'siphash24.pyx',
  command: [py, tempita, '@INPUT@', '@OUTPUT@']
)

py.extension_module(
  'siphash24',
  pyx,
  dependencies: libcsiphash,
  install: true
)
